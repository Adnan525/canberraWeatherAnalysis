---
title: "ACT weather analysis"
author: "Muntasir Adnan"
date: "11/10/2022"
output: html_document
---

# Load the dataset into a dataframe named df
```{r}
library(tidyverse)
library(ggplot2)
df <- read.csv("act_weather.csv")
head(df)
```
# remove the first column since it's just a copy of the index value
```{r}
df <- df[-c(1)]
head(df)
```
# chek the data has been loaded correctly
```{r}
nrow(df)
ncol(df)
str(df)
```
# create a function that takes the column name as a parametre and prints minimum, median, mean and maximum
```{r}
getSummary <- function(colName)
{
  writeLines(paste(paste(colName, "summary:"),
                   "================",
                   paste("minimum : ", min(df[colName])),
                   paste("median : ", median(df[[colName]])),
                   paste("mean : ", mean(df[[colName]])),
                   paste("maximum : ", max(df[colName])),
                   sep = '\n'))
  }
```
# make a vector to hold the column names, use make.names to convert them to correct name
```{r}
targetColumns <- c("Minimum_temperature",
                  "9am_Temperature",
                  "Speed_of_maximum_wind_gust_(km/h)",
                  "3pm_Temperature")
targetColumns <- make.names(targetColumns)
```
# run a loop to get the summary using function getSummary
```{r}
for (columnName in targetColumns)
{
  getSummary(columnName)
}
```
# average minimum temperature of each month
```{r}
averageMinTemp <- df %>% 
  group_by(Month, Year) %>%
  summarise(avgMinTempByMonth = mean(Minimum_temperature))
head(averageMinTemp)
```
# average of the speed of maximum wind gust per each group of direction
# grouped by wind direction
```{r}
averageWindGust <- df %>% 
  group_by(Direction_of_maximum_wind_gust) %>% 
  summarise(mean(Speed_of_maximum_wind_gust_.km.h.))
head(averageWindGust)
```
# highest rainfall month
```{r}
highestRainFall <- df %>% 
  group_by(Month, Year) %>% 
  summarise(totalRainfall = sum(Rainfall_.mm.))
highestRainFall[which.max(highestRainFall$totalRainfall),]
```
# highest rainfall by year, using highestRainFall data frame created in the previous chunk
```{r}
highestRainFallByYear <- highestRainFall %>% 
  group_by(Year) %>% 
  summarise(totalRainFall = sum(totalRainfall))
#By using which.max function got highest rainfall during those years with their index number and by printing the index number got the value for highest rainfall year.
highestRainFallByYear[which.max(highestRainFallByYear$totalRainFall),]
```
# least amount of rainfall or dry month
```{r}
dryMonth <- df %>% 
  group_by(Month, Year) %>% 
  summarise(sumRainfall = sum(Rainfall_.mm.))
#least amount of rain
print("Least amount of rain fall :")
dryMonth[which.min(dryMonth$sumRainfall),]
#dry month
print("dry month  where rain fall is 0 :")
no_rainfall_month <- dryMonth[which(dryMonth$sumRainfall == 0), "Month"]
no_rainfall_year <- dryMonth[which(dryMonth$sumRainfall == 0), "Year"]
#none
```
# function to calculate an average between 2 numbers
```{r}
getAvg <- function(a, b)
{
  (a+b)/2
}
```

# highest hiumidity in 2019
```{r}
highestHumid2019 <- df %>% 
  filter(Year == 2019) %>% 
  group_by(Month) %>% 
  summarise(maxHumid = max(getAvg(X9am_relative_humidity_..., X3pm_relative_humidity_...)))
highestHumid2019[which.max(highestHumid2019$maxHumid),]
```
# August 2020 to July 2021 summary table showing min, max and ave temp, wind speed, humidity for each month, for each quarter
## getting a subset of df which has all the rows from August 2020 to July 2021 inclusive
```{r}
#get the subset
data20to21 <- df %>% 
  filter((Year == 2020 & Month >= 8)|(Year == 2021 & Month <= 7))
```
## wind speed columns has values as "Calm"
## since only numeric data can be processed and it's not clear what the dataset means by "calm", I will replace them with mean
## converting the column to numeric and replacing NAs with mean() will solve the issue
```{r}
#make numeric
data20to21$X9am_wind_speed_.km.h. <- as.numeric(data20to21$X9am_wind_speed_.km.h.)
data20to21$X3pm_wind_speed_.km.h. <- as.numeric(data20to21$X3pm_wind_speed_.km.h.)

#fix NAs with mean
data20to21$X9am_wind_speed_.km.h.[is.na(data20to21$X9am_wind_speed_.km.h.)] <- mean(data20to21$X9am_wind_speed_.km.h., 
                                                                                    na.rm = TRUE)
data20to21$X3pm_wind_speed_.km.h.[is.na(data20to21$X3pm_wind_speed_.km.h.)] <- mean(data20to21$X3pm_wind_speed_.km.h., 
                                                                                    na.rm = TRUE)
```
# Getting min, max, average of temparature, wind speed and humidity by month
```{r}
result <- data20to21 %>% 
  group_by(Month, Year) %>% 
  summarise(minTemp = min(Minimum_temperature), 
            maxTemp = max(Maximum_temperature), 
            aveTemp = mean((Maximum_temperature +Minimum_temperature)/2),
            minWind = min(Speed_of_maximum_wind_gust_.km.h.), 
            maxWind = max(Speed_of_maximum_wind_gust_.km.h.), 
            avWindSpeed = mean((X9am_wind_speed_.km.h. + X3pm_wind_speed_.km.h.)/2),
            avHumidity = mean((X3pm_relative_humidity_... + X9am_relative_humidity_...)/2),
            maxHumid = if (max(X3pm_relative_humidity_...)> max(X9am_relative_humidity_...)) max(X3pm_relative_humidity_...) else max(X9am_relative_humidity_...),
            minHumid = if (min(X3pm_relative_humidity_...)< min(X9am_relative_humidity_...)) min(X3pm_relative_humidity_...) else min(X9am_relative_humidity_...))
```
# Getting min, max, average of temparature, wind speed and humidity by quarter, a loop that increments by +2 will help
```{r}
#quarter
resultQuarter <- data.frame(matrix(ncol = 10, nrow = 0))
colnames(resultQuarter) <- c("quarter", "minTemp", "maxTemp", "avTemp", "minWind", "maxWind", "avWind", "minHum", "maxHum", "avHum")
quarter = 0
for (i in c(1,4,7,10))
{
  quarter = quarter + 1
  temp <- c()
  temp <- append(temp, quarter)
  temp <- append(temp, min(c(result$minTemp[i], result$minTemp[i+1], result$minTemp[i+2])))
  temp <- append(temp, max(c(result$maxTemp[i], result$maxTemp[i+1], result$maxTemp[i+2])))
  temp <- append(temp, mean(c(result$aveTemp[i], result$aveTemp[i+1], result$aveTemp[i+2])))
  
  temp <- append(temp, min(c(result$minWind[i], result$minWind[i+1], result$minWind[i+2])))
  temp <- append(temp, max(c(result$maxWind[i], result$maxWind[i+1], result$maxWind[i+2])))
  temp <- append(temp, mean(c(result$avWindSpeed[i], result$avWindSpeed[i+1], result$avWindSpeed[i+2])))
  
  temp <- append(temp, min(c(result$minHumid[i], result$minHumid[i+1], result$minHumid[i+2])))
  temp <- append(temp, max(c(result$maxHumid[i], result$maxHumid[i+1], result$maxHumid[i+2])))
  temp <- append(temp, mean(c(result$avHumidity[i], result$avHumidity[i+1], result$avHumidity[i+2])))
  
  resultQuarter[nrow(resultQuarter) + 1,] <- temp
  
}
```
# plots month
# temparature
```{r}
result$Month <- as.factor(result$Month)
monthTempPlot <- ggplot(result)+
  geom_point(aes(x=Month,y=aveTemp, colour = ""))+
  scale_colour_manual("Temperature C", values = c(Lowest = "blue", Average = "green", Highest ="red"))+
  ylab("Temperature C")+
  stat_summary(aes(x=Month,y=minTemp),fun="min",geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=Month,y=maxTemp),fun="max",geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=Month,y=aveTemp),fun="mean",geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of the temperature from August 2020 to July 2021 monthly")
monthTempPlot
```
# wind
```{r}
monthWindPlot <- ggplot(result)+
  geom_point(aes(x=Month,y=avWindSpeed, colour = ""))+
  scale_colour_manual("Wind-Speed", values = c(Minimum = "blue", Average = "green", Maximum="red"))+
  ylab("Wind Speed KM/h")+
  stat_summary(aes(x=Month,y=minWind),fun="min",geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=Month,y=maxWind),fun="max",geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=Month,y=avWindSpeed),fun="mean",geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of wind speed in KM/h from August 2020 to July 2021 monthly")
monthWindPlot
```
# humidity
```{r}
monthHumidPlot <- ggplot(result)+
  geom_point(aes(x=Month,y=avHumidity, colour = ""))+
  scale_colour_manual("Humidity", values = c(Minimum = "blue", Average = "green", Maximum="red"))+
  ylab("Humidity")+
  stat_summary(aes(x=Month,y=minHumid),fun="min",geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=Month,y=maxHumid),fun="max",geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=Month,y=avHumidity),fun="mean",geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of humidity from August 2020 to July 2021 monthly")
monthHumidPlot
```
# quarter
# temparature
```{r}
quarterTempPlot <- ggplot(resultQuarter)+
  geom_point(aes(x=quarter,y=avTemp, colour = ""))+
  scale_colour_manual("Temperature C", values = c(Minimum = "blue", Average = "green", Maximum="red"))+
  ylab("Temperature C")+
  stat_summary(aes(x=quarter,y=minTemp), fun = "min", geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=quarter,y=maxTemp), fun = "max", geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=quarter,y=avTemp), fun = "mean", geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of temperature in C from August 2020 to July 2021 quarterly")
quarterTempPlot
```
# wind speed 
```{r}
quarterWindPlot <- ggplot(resultQuarter)+
  geom_point(aes(x=quarter,y=avWind, colour = ""))+
  scale_colour_manual("Wind Speed KM/h", values = c(Minimum = "blue", Average = "green", Maximum="red"))+
  ylab("Wind Speed KM/h")+
  stat_summary(aes(x=quarter,y=minWind), fun = "min", geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=quarter,y=maxWind), fun = "max", geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=quarter,y=avWind), fun = "mean", geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of wind-speed in KM/h from August 2020 to July 2021 quarterly")
quarterWindPlot
```
# humidity
```{r}
quarterHumidityPlot <- ggplot(resultQuarter)+
  geom_point(aes(x=quarter,y=avHum, colour = ""))+
  scale_colour_manual("Humidity", values = c(Minimum = "blue", Average = "green", Maximum="red"))+
  ylab("Humidity")+
  stat_summary(aes(x=quarter,y=minHum), fun = "min", geom="point",shape=20,size=5,color="blue")+
  stat_summary(aes(x=quarter,y=maxHum), fun = "max", geom="point",shape=20,size=5,color="red")+
  stat_summary(aes(x=quarter,y=avHum), fun = "mean", geom="point",shape=20,size=5,color="green")+
  theme(legend.position = "right")+
  ggtitle("Distribution of humidity from August 2020 to July 2021 quarterly")
quarterHumidityPlot
```

